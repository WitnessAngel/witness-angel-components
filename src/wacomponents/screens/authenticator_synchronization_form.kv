#:import tr wacomponents.i18n.tr
#:import strip_external_app_root_prefix wacomponents.default_settings.strip_external_app_root_prefix



<AuthenticatorSynchronizationScreen>:

    # on_pre_enter: root.refresh_status()

    MDBoxLayout:
        orientation: "vertical"

        MDToolbar:
            title: tr._("Publish authenticator")
            id: initialization_form_toolbar
            left_action_items: [["arrow-left", lambda x: root.go_to_home_screen(), tr._("Back")]]
            right_action_items: [["refresh", lambda x: root.refresh_status(), tr._("Refresh")],["help-circle-outline", lambda x: root.display_help_popup(), tr._("Help")]]

        GridLayout:
            padding: [20, 20, 20, 20]
            spacing: [20, 20]
            cols: 1

            MDLabel:
                text: tr._("Authenticator:") + " " + strip_external_app_root_prefix(root.selected_authenticator_dir)
                halign: "center"


            ScrollView:
                size_hint_y: 2
                id: synchronization_information_scrollview

                WASelectableLabel:
                    id: synchronization_information
                    padding_x: [10,0]
                    halign: "left"
                    size_hint: 1, None
                    height: max((len(self._lines)+1) * self.line_height, synchronization_information_scrollview.height)
                    text: tr._("<empty>")

            MDLabel:
                id: publication_details
                padding: [10,0]
                size_hint_y: 2
                halign:"left"
                theme_text_color:"Error"



            VSeparator:

            RelativeLayout :
                height: dp(50)

                MDRectangleFlatButton:
                    id: button_initialize
                    text: tr._("Publish")
                    size_hint: .5, 1
                    # For some reason, setting "height" here causes infinite recursions in layout
                    size_hint_min_y: dp(50)
                    size_hint_max_y: dp(50)
                    pos_hint: {'x': .25}
                    disabled: root.is_synchronized is not True
                    on_press: root.publish_authenticator()

            Widget:

            AnchorLayout:
                size_hint: 1, 1
                pos: 300,300

                MDLabel:
                    id: operation_status_label
                    text:


